# OpenClash èŠ‚ç‚¹ç®¡ç†é¢æ¿

ä¸€ä¸ªåŸºäºWebçš„OpenClashèŠ‚ç‚¹ç®¡ç†å·¥å…·ï¼Œæä¾›å¯è§†åŒ–çš„èŠ‚ç‚¹ç®¡ç†å’Œè‡ªåŠ¨åŒ–åŒæ­¥åŠŸèƒ½ã€‚

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- **èŠ‚ç‚¹ç®¡ç†**: æ”¯æŒå…¨åè®®èŠ‚ç‚¹ï¼ˆss:// vmess:// vless:// trojan:// http:// socks:// ç­‰ï¼‰
- **è‡ªåŠ¨åŒæ­¥**: å®ˆæŠ¤è¿›ç¨‹ç›‘æ§èŠ‚ç‚¹æ–‡ä»¶å˜åŒ–ï¼Œè‡ªåŠ¨åŒæ­¥åˆ°OpenClash
- **çŠ¶æ€ç›‘æ§**: å®æ—¶ç›‘æ§å®ˆæŠ¤è¿›ç¨‹å’ŒOpenClashè¿è¡ŒçŠ¶æ€
- **æ—¥å¿—ç®¡ç†**: æŸ¥çœ‹å’Œç®¡ç†è¿è¡Œæ—¥å¿—
- **ç³»ç»Ÿä¿¡æ¯**: æ˜¾ç¤ºç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ

### ç•Œé¢ç‰¹æ€§
- **ç°ä»£åŒ–UI**: åŸºäºBootstrap 5çš„å“åº”å¼è®¾è®¡
- **å®æ—¶æ›´æ–°**: è‡ªåŠ¨åˆ·æ–°çŠ¶æ€å’Œæ—¥å¿—ä¿¡æ¯
- **æ“ä½œåé¦ˆ**: Toasté€šçŸ¥ç³»ç»Ÿ
- **ç§»åŠ¨å‹å¥½**: æ”¯æŒç§»åŠ¨è®¾å¤‡è®¿é—®

## ğŸ“ é¡¹ç›®ç»“æ„

```
OpenClashManage/
â”œâ”€â”€ app.py                 # Flaskåº”ç”¨ä¸»æ–‡ä»¶
â”œâ”€â”€ requirements.txt       # Pythonä¾èµ–
â”œâ”€â”€ README.md             # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ index.html        # ä¸»é¡µæ¨¡æ¿
â”œâ”€â”€ jk.sh                 # å®ˆæŠ¤è¿›ç¨‹è„šæœ¬
â”œâ”€â”€ jx.py                 # èŠ‚ç‚¹è§£æå™¨
â”œâ”€â”€ log.py                # æ—¥å¿—æ¨¡å—
â”œâ”€â”€ zc.py                 # ç­–ç•¥ç»„æ³¨å…¥å™¨
â”œâ”€â”€ zr.py                 # ä¸»åŒæ­¥è„šæœ¬
â”œâ”€â”€ zw.py                 # ä»£ç†èŠ‚ç‚¹æ³¨å…¥å™¨
â””â”€â”€ wangluo/
    â”œâ”€â”€ nodes.txt         # èŠ‚ç‚¹æ–‡ä»¶
    â””â”€â”€ log.txt           # æ—¥å¿—æ–‡ä»¶
```

## ğŸ› ï¸ å®‰è£…å’Œè¿è¡Œ

### ğŸš€ ä¸€é”®å®‰è£…ï¼ˆæ¨èï¼‰

#### é€šç”¨ä¸€é”®å®‰è£…å‘½ä»¤
```bash
curl -sSL https://raw.githubusercontent.com/kuku0799/OpenClashManage/main/install.sh | bash
```

#### å¦‚æœcurlæœ‰é—®é¢˜ï¼Œä½¿ç”¨wgetç‰ˆæœ¬
```bash
wget -qO- https://raw.githubusercontent.com/kuku0799/OpenClashManage/main/install_wget.sh | bash
```

### OpenWrt ç³»ç»Ÿä¸“ç”¨å®‰è£…

#### æ–¹æ³•ä¸€ï¼šæ ‡å‡†å®‰è£…
```bash
curl -sSL https://raw.githubusercontent.com/kuku0799/OpenClashManage/main/install_openwrt_robust.sh | bash
```

#### æ–¹æ³•äºŒï¼šwgetå®‰è£…ï¼ˆcurlæœ‰é—®é¢˜æ—¶ä½¿ç”¨ï¼‰
```bash
wget -qO- https://raw.githubusercontent.com/kuku0799/OpenClashManage/main/install_openwrt_wget.sh | bash
```

#### æ–¹æ³•ä¸‰ï¼šä¿®å¤curlä¾èµ–åå®‰è£…
å¦‚æœé‡åˆ°curlåº“ä¾èµ–é—®é¢˜ï¼Œå…ˆè¿è¡Œä¿®å¤è„šæœ¬ï¼š
```bash
wget -qO- https://raw.githubusercontent.com/kuku0799/OpenClashManage/main/fix_curl_deps.sh | bash
```
ç„¶åé‡æ–°è¿è¡Œæ ‡å‡†å®‰è£…ã€‚

### é€šç”¨å®‰è£…ï¼ˆå…¶ä»–ç³»ç»Ÿï¼‰

#### 1. å®‰è£…ä¾èµ–
```bash
pip3 install -r requirements.txt
```

#### 2. å¯åŠ¨Webé¢æ¿
```bash
python3 app.py
```

#### 3. è®¿é—®é¢æ¿
æ‰“å¼€æµè§ˆå™¨è®¿é—®: `http://your-ip:8888`

## ğŸ“‹ ä½¿ç”¨è¯´æ˜

### èŠ‚ç‚¹ç®¡ç†
1. åœ¨"èŠ‚ç‚¹ç®¡ç†"åŒºåŸŸç²˜è´´èŠ‚ç‚¹é“¾æ¥ï¼ˆä¸€è¡Œä¸€ä¸ªï¼‰
2. æ”¯æŒåè®®ï¼šå…¨åè®®æ”¯æŒï¼ˆss:// vmess:// vless:// trojan:// http:// socks:// ç­‰ï¼‰
3. ç‚¹å‡»"ä¿å­˜èŠ‚ç‚¹"æŒ‰é’®ä¿å­˜

### å®ˆæŠ¤è¿›ç¨‹
- **å¯åŠ¨**: ç‚¹å‡»"å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹"å¼€å§‹è‡ªåŠ¨ç›‘æ§
- **åœæ­¢**: ç‚¹å‡»"åœæ­¢å®ˆæŠ¤è¿›ç¨‹"åœæ­¢è‡ªåŠ¨ç›‘æ§
- **çŠ¶æ€**: å®æ—¶æ˜¾ç¤ºå®ˆæŠ¤è¿›ç¨‹è¿è¡ŒçŠ¶æ€

### æ‰‹åŠ¨æ“ä½œ

## ğŸ—‘ï¸ å¸è½½åŠŸèƒ½

### Linux/OpenWrt ç³»ç»Ÿå¸è½½
```bash
# ä¸‹è½½å¹¶è¿è¡Œå¸è½½è„šæœ¬
wget -qO- https://raw.githubusercontent.com/kuku0799/OpenClashManage/main/uninstall.sh | bash

# æˆ–è€…ç›´æ¥è¿è¡Œ
bash uninstall.sh
```

### Windows ç³»ç»Ÿå¸è½½
```powershell
# ä¸‹è½½å¹¶è¿è¡ŒPowerShellå¸è½½è„šæœ¬
Invoke-Expression (Invoke-WebRequest -Uri "https://raw.githubusercontent.com/kuku0799/OpenClashManage/main/uninstall.ps1" -UseBasicParsing).Content

# æˆ–è€…ç›´æ¥è¿è¡Œ
.\uninstall.ps1
```

### å¸è½½åŠŸèƒ½è¯´æ˜
- âœ… **å®Œå…¨æ¸…ç†**: åˆ é™¤æ‰€æœ‰åº”ç”¨æ–‡ä»¶ã€æœåŠ¡ã€æ—¥å¿—
- âœ… **è¿›ç¨‹æ¸…ç†**: è‡ªåŠ¨åœæ­¢å’Œæ¸…ç†æ®‹ç•™è¿›ç¨‹
- âœ… **ç«¯å£æ£€æŸ¥**: æ£€æŸ¥å¹¶æç¤ºç«¯å£å ç”¨æƒ…å†µ
- âœ… **ç¼“å­˜æ¸…ç†**: æ¸…ç†Pythonç¼“å­˜æ–‡ä»¶
- âœ… **å®‰å…¨ç¡®è®¤**: éœ€è¦ç”¨æˆ·ç¡®è®¤åæ‰æ‰§è¡Œå¸è½½
- âœ… **é‡æ–°å®‰è£…**: æä¾›é‡æ–°å®‰è£…çš„æŒ‡å¯¼ä¿¡æ¯

### è°ƒè¯•æ¨¡å¼
å¦‚æœéœ€è¦å¿«é€Ÿå¸è½½è¿›è¡Œè°ƒè¯•ï¼Œå¯ä»¥ä½¿ç”¨ï¼š
```bash
# Linux/OpenWrt
echo "y" | bash uninstall.sh

# Windows PowerShell
.\uninstall.ps1 -Force
```
- **æ‰‹åŠ¨åŒæ­¥**: ç«‹å³æ‰§è¡ŒèŠ‚ç‚¹åŒæ­¥æ“ä½œ
- **é‡å¯OpenClash**: é‡å¯OpenClashæœåŠ¡
- **æ¸…ç©ºæ—¥å¿—**: æ¸…ç©ºè¿è¡Œæ—¥å¿—
- **åˆ·æ–°æ—¥å¿—**: æ‰‹åŠ¨åˆ·æ–°æ—¥å¿—æ˜¾ç¤º

### ç³»ç»Ÿç›‘æ§
- **å†…å­˜ä½¿ç”¨**: æ˜¾ç¤ºç³»ç»Ÿå†…å­˜ä½¿ç”¨æƒ…å†µ
- **ç£ç›˜ä½¿ç”¨**: æ˜¾ç¤ºç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µ
- **CPUè´Ÿè½½**: æ˜¾ç¤ºç³»ç»ŸCPUè´Ÿè½½

## ğŸ”§ é…ç½®è¯´æ˜

### è·¯å¾„é…ç½®
åœ¨ `app.py` ä¸­å¯ä»¥ä¿®æ”¹ä»¥ä¸‹è·¯å¾„ï¼š
```python
ROOT_DIR = "/root/OpenClashManage"        # é¡¹ç›®æ ¹ç›®å½•
NODES_FILE = f"{ROOT_DIR}/wangluo/nodes.txt"  # èŠ‚ç‚¹æ–‡ä»¶è·¯å¾„
LOG_FILE = f"{ROOT_DIR}/wangluo/log.txt"      # æ—¥å¿—æ–‡ä»¶è·¯å¾„
CONFIG_FILE = "/etc/openclash/config.yaml"    # OpenClashé…ç½®æ–‡ä»¶
PID_FILE = "/tmp/openclash_watchdog.pid"      # å®ˆæŠ¤è¿›ç¨‹PIDæ–‡ä»¶
```

### ç«¯å£é…ç½®
é»˜è®¤ç«¯å£ä¸º8888ï¼Œå¯åœ¨ `app.py` åº•éƒ¨ä¿®æ”¹ï¼š
```python
app.run(host='0.0.0.0', port=8888, debug=False)
```

## ğŸ”„ å·¥ä½œæµç¨‹

1. **ç›‘æ§**: å®ˆæŠ¤è¿›ç¨‹ç›‘æ§ `nodes.txt` æ–‡ä»¶å˜åŒ–
2. **è§£æ**: `jx.py` è§£æå„ç§åè®®çš„èŠ‚ç‚¹é“¾æ¥
3. **æ³¨å…¥**: `zw.py` å°†èŠ‚ç‚¹æ³¨å…¥é…ç½®ï¼Œ`zc.py` æ›´æ–°ç­–ç•¥ç»„
4. **éªŒè¯**: éªŒè¯é…ç½®æœ‰æ•ˆæ€§å¹¶å¤‡ä»½
5. **é‡å¯**: é‡å¯OpenClashæœåŠ¡åº”ç”¨æ–°é…ç½®

## ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§

- **è¿›ç¨‹ä¿æŠ¤**: é˜²æ­¢é‡å¤å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹
- **é…ç½®å¤‡ä»½**: è‡ªåŠ¨å¤‡ä»½å’Œå›æ»šæœºåˆ¶
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- **æƒé™æ£€æŸ¥**: æ–‡ä»¶è¯»å†™æƒé™éªŒè¯

## ğŸ“Š çŠ¶æ€æŒ‡ç¤º

- ğŸŸ¢ **ç»¿è‰²è„‰å†²**: æœåŠ¡è¿è¡Œä¸­
- ğŸ”´ **çº¢è‰²åœ†ç‚¹**: æœåŠ¡å·²åœæ­¢
- âš ï¸ **é»„è‰²è­¦å‘Š**: æ“ä½œéœ€è¦ç¡®è®¤
- âœ… **æˆåŠŸæ“ä½œ**: æ“ä½œæ‰§è¡ŒæˆåŠŸ
- âŒ **å¤±è´¥æ“ä½œ**: æ“ä½œæ‰§è¡Œå¤±è´¥

## ğŸ” æ•…éšœæ’é™¤

### OpenWrt å®‰è£…é—®é¢˜

#### 1. å­˜å‚¨ç©ºé—´ä¸è¶³
**é”™è¯¯ä¿¡æ¯**: `Only have 0kb available on filesystem /overlay`
**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ¸…ç†opkgç¼“å­˜
opkg clean

# åˆ é™¤ä¸éœ€è¦çš„è½¯ä»¶åŒ…
opkg list-installed | grep -v "openclash\|python3\|wget" | xargs opkg remove

# é‡å¯ç³»ç»Ÿé‡Šæ”¾ä¸´æ—¶æ–‡ä»¶
reboot
```

#### 2. curlåº“ä¾èµ–é—®é¢˜
**é”™è¯¯ä¿¡æ¯**: `Error loading shared library libmbedtls.so.21`
**è§£å†³æ–¹æ¡ˆ**:
```bash
# è¿è¡Œä¿®å¤è„šæœ¬
wget -qO- https://raw.githubusercontent.com/kuku0799/OpenClashManage/main/fix_curl_deps.sh | bash

# æˆ–ä½¿ç”¨wgetå®‰è£…
wget -qO- https://raw.githubusercontent.com/kuku0799/OpenClashManage/main/install_openwrt_wget.sh | bash
```

#### 3. PythonåŒ…å®‰è£…å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**:
```bash
# ä½¿ç”¨opkgå®‰è£…PythonåŒ…
opkg install python3-light python3-yaml python3-flask

# æˆ–é™çº§åˆ°ç¨³å®šç‰ˆæœ¬
opkg install --force-downgrade python3=3.10.13-2
```

### é€šç”¨é—®é¢˜

1. **å®ˆæŠ¤è¿›ç¨‹æ— æ³•å¯åŠ¨**
   - æ£€æŸ¥ `jk.sh` æ–‡ä»¶æƒé™
   - ç¡®è®¤Python3å·²å®‰è£…
   - æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶é”™è¯¯ä¿¡æ¯

2. **èŠ‚ç‚¹åŒæ­¥å¤±è´¥**
   - æ£€æŸ¥èŠ‚ç‚¹é“¾æ¥æ ¼å¼
   - ç¡®è®¤OpenClashé…ç½®æ–‡ä»¶è·¯å¾„
   - éªŒè¯èŠ‚ç‚¹è§£æå™¨å·¥ä½œæ­£å¸¸

3. **Webé¢æ¿æ— æ³•è®¿é—®**
   - æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
   - ç¡®è®¤ç«¯å£8888æœªè¢«å ç”¨
   - éªŒè¯Flaskåº”ç”¨æ­£å¸¸å¯åŠ¨

### æ—¥å¿—æŸ¥çœ‹
```bash
# æŸ¥çœ‹è¿è¡Œæ—¥å¿—
tail -f /root/OpenClashManage/wangluo/log.txt

# æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
logread | grep openclash
```

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- æ”¯æŒå¤šç§ä»£ç†åè®®
- å®ç°è‡ªåŠ¨åŒ–èŠ‚ç‚¹åŒæ­¥
- æä¾›Webç®¡ç†ç•Œé¢

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ã€‚ 